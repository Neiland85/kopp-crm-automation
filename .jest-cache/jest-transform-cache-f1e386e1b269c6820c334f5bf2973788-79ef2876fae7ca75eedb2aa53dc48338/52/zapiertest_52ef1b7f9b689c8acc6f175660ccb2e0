a00164ffb0e8f79b6a53c90cde4ef3de
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock del logger
jest.mock('fs/promises');
const index_1 = __importDefault(require("../src/zapier/index"));
const common_1 = require("../src/zapier/utils/common");
describe('Form Submission Trigger', () => {
    test('should have correct trigger configuration', () => {
        const trigger = index_1.default.triggers.new_form_submission;
        expect(trigger).toBeDefined();
        expect(trigger.key).toBe('new_form_submission');
        expect(trigger.noun).toBe('Form Submission');
        expect(trigger.display.label).toBe('New Form Submission');
        expect(trigger.operation.type).toBe('polling');
        expect(typeof trigger.operation.perform).toBe('function');
    });
    test('should have correct output fields', () => {
        const trigger = index_1.default.triggers.new_form_submission;
        const outputFields = trigger.operation.outputFields;
        expect(outputFields).toBeDefined();
        expect(Array.isArray(outputFields)).toBe(true);
        const fieldKeys = outputFields?.map((field) => field.key) || [];
        expect(fieldKeys).toContain('id');
        expect(fieldKeys).toContain('contact_email');
        expect(fieldKeys).toContain('submitted_at');
        expect(fieldKeys).toContain('form_id');
    });
    test('should have sample data', () => {
        const trigger = index_1.default.triggers.new_form_submission;
        expect(trigger.operation.sample).toBeDefined();
        expect(trigger.operation.sample).toHaveProperty('id');
        expect(trigger.operation.sample).toHaveProperty('contact_email');
        expect(trigger.operation.sample).toHaveProperty('submitted_at');
    });
});
describe('Page View Trigger', () => {
    test('should have correct trigger configuration', () => {
        const trigger = index_1.default.triggers.new_page_view;
        expect(trigger).toBeDefined();
        expect(trigger.key).toBe('new_page_view');
        expect(trigger.noun).toBe('Page View');
        expect(trigger.display.label).toBe('New Page View');
        expect(trigger.operation.type).toBe('polling');
        expect(typeof trigger.operation.perform).toBe('function');
    });
    test('should have correct output fields', () => {
        const trigger = index_1.default.triggers.new_page_view;
        const outputFields = trigger.operation.outputFields;
        expect(outputFields).toBeDefined();
        expect(Array.isArray(outputFields)).toBe(true);
        const fieldKeys = outputFields?.map((field) => field.key) || [];
        expect(fieldKeys).toContain('id');
        expect(fieldKeys).toContain('page_url');
        expect(fieldKeys).toContain('timestamp');
    });
});
describe('HubSpot Contact Create Action', () => {
    test('should have correct create configuration', () => {
        const create = index_1.default.creates.hubspot_contact;
        expect(create).toBeDefined();
        expect(create.key).toBe('hubspot_contact');
        expect(create.noun).toBe('Contact');
        expect(create.display.label).toBe('Create or Update HubSpot Contact');
        expect(typeof create.operation.perform).toBe('function');
    });
    test('should have required input fields', () => {
        const create = index_1.default.creates.hubspot_contact;
        const inputFields = create.operation.inputFields;
        expect(inputFields).toBeDefined();
        expect(Array.isArray(inputFields)).toBe(true);
        const emailField = inputFields.find((field) => field.key === 'email');
        expect(emailField).toBeDefined();
        expect(emailField?.required).toBe(true);
        const fieldKeys = inputFields.map((field) => field.key);
        expect(fieldKeys).toContain('email');
        expect(fieldKeys).toContain('firstname');
        expect(fieldKeys).toContain('lastname');
        expect(fieldKeys).toContain('form_name');
        expect(fieldKeys).toContain('submitted_at');
    });
    test('should have sample output', () => {
        const create = index_1.default.creates.hubspot_contact;
        expect(create.operation.sample).toBeDefined();
        expect(create.operation.sample).toHaveProperty('email');
        expect(create.operation.sample).toHaveProperty('firstname');
        expect(create.operation.sample).toHaveProperty('lastname');
    });
});
describe('Slack Notification Create Action', () => {
    test('should have correct create configuration', () => {
        const create = index_1.default.creates.slack_notification;
        expect(create).toBeDefined();
        expect(create.key).toBe('slack_notification');
        expect(create.noun).toBe('Slack Message');
        expect(create.display.label).toBe('Send Slack Notification');
        expect(typeof create.operation.perform).toBe('function');
    });
    test('should have required input fields', () => {
        const create = index_1.default.creates.slack_notification;
        const inputFields = create.operation.inputFields;
        expect(inputFields).toBeDefined();
        expect(Array.isArray(inputFields)).toBe(true);
        const emailField = inputFields.find((field) => field.key === 'email');
        expect(emailField).toBeDefined();
        expect(emailField?.required).toBe(true);
        const fieldKeys = inputFields.map((field) => field.key);
        expect(fieldKeys).toContain('email');
        expect(fieldKeys).toContain('form_name');
        expect(fieldKeys).toContain('submitted_at');
    });
    test('should have sample output with Block Kit format', () => {
        const create = index_1.default.creates.slack_notification;
        expect(create.operation.sample).toBeDefined();
        expect(create.operation.sample).toHaveProperty('blocks');
        expect(Array.isArray(create.operation.sample.blocks)).toBe(true);
        const firstBlock = create.operation.sample.blocks[0];
        expect(firstBlock).toHaveProperty('type', 'section');
        expect(firstBlock).toHaveProperty('text');
        expect(firstBlock.text).toHaveProperty('type', 'mrkdwn');
        expect(firstBlock.text.text).toContain('ðŸ“© *Nuevo Form Submission*');
    });
});
describe('App Authentication', () => {
    test('should have custom authentication configuration', () => {
        expect(index_1.default.authentication).toBeDefined();
        expect(index_1.default.authentication.type).toBe('custom');
        expect(index_1.default.authentication.fields).toBeDefined();
        expect(Array.isArray(index_1.default.authentication.fields)).toBe(true);
        const fieldKeys = index_1.default.authentication.fields.map((field) => field.key);
        expect(fieldKeys).toContain('hubspot_api_key');
        expect(fieldKeys).toContain('slack_webhook_url');
    });
    test('should have authentication test endpoint', () => {
        expect(index_1.default.authentication.test).toBeDefined();
        expect(index_1.default.authentication.test.url).toContain('hubapi.com');
        expect(index_1.default.authentication.test.method).toBe('GET');
    });
});
describe('App Middleware', () => {
    test('should have beforeRequest middleware', () => {
        expect(index_1.default.beforeRequest).toBeDefined();
        expect(Array.isArray(index_1.default.beforeRequest)).toBe(true);
        expect(index_1.default.beforeRequest.length).toBeGreaterThan(0);
        expect(typeof index_1.default.beforeRequest[0]).toBe('function');
    });
    test('should have afterResponse middleware', () => {
        expect(index_1.default.afterResponse).toBeDefined();
        expect(Array.isArray(index_1.default.afterResponse)).toBe(true);
        expect(index_1.default.afterResponse.length).toBeGreaterThan(0);
        expect(typeof index_1.default.afterResponse[0]).toBe('function');
    });
});
describe('Utility Functions', () => {
    test('withRetry should handle failures and retries', async () => {
        let attempts = 0;
        const flakyOperation = jest.fn(async () => {
            attempts++;
            if (attempts < 3) {
                throw new Error('Temporary failure');
            }
            return 'success';
        });
        const result = await (0, common_1.withRetry)(flakyOperation, 3, 10);
        expect(result).toBe('success');
        expect(attempts).toBe(3);
        expect(flakyOperation).toHaveBeenCalledTimes(3);
    });
    test('withRetry should fail after max retries', async () => {
        const alwaysFailOperation = jest.fn(async () => {
            throw new Error('Always fails');
        });
        await expect((0, common_1.withRetry)(alwaysFailOperation, 2, 10)).rejects.toThrow('Always fails');
        expect(alwaysFailOperation).toHaveBeenCalledTimes(3); // initial + 2 retries
    });
    test('mapFormFieldsToHubSpot should map form fields correctly', () => {
        const formValues = [
            { name: 'email', value: 'test@example.com' },
            { name: 'first_name', value: 'John' },
            { name: 'last_name', value: 'Doe' },
            { name: 'phone', value: '+1-234-567-8900' },
            { name: 'company', value: 'Test Corp' },
        ];
        const mapped = (0, common_1.mapFormFieldsToHubSpot)(formValues);
        expect(mapped).toHaveProperty('email', 'test@example.com');
        expect(mapped).toHaveProperty('firstname', 'John');
        expect(mapped).toHaveProperty('lastname', 'Doe');
        expect(mapped).toHaveProperty('phone', '+12345678900');
        expect(mapped).toHaveProperty('company', 'Test Corp');
    });
    test('mapFormFieldsToHubSpot should skip invalid emails', () => {
        const formValues = [
            { name: 'email', value: 'invalid-email' },
            { name: 'firstname', value: 'John' },
        ];
        const mapped = (0, common_1.mapFormFieldsToHubSpot)(formValues);
        expect(mapped).not.toHaveProperty('email');
        expect(mapped).toHaveProperty('firstname', 'John');
    });
    test('isValidEmail should validate email addresses correctly', () => {
        expect((0, common_1.isValidEmail)('test@example.com')).toBe(true);
        expect((0, common_1.isValidEmail)('user.name+tag@example.co.uk')).toBe(true);
        expect((0, common_1.isValidEmail)('invalid-email')).toBe(false);
        expect((0, common_1.isValidEmail)('')).toBe(false);
        expect((0, common_1.isValidEmail)('test@')).toBe(false);
        expect((0, common_1.isValidEmail)('@example.com')).toBe(false);
        expect((0, common_1.isValidEmail)('test..test@example.com')).toBe(false);
    });
    test('logZapAction should handle logging gracefully', async () => {
        const mockZ = {
            console: {
                log: jest.fn(),
                error: jest.fn(),
            },
        };
        // Should not throw even if logging fails
        await expect((0, common_1.logZapAction)(mockZ, {
            action: 'test_action',
            timestamp: new Date().toISOString(),
            success: true,
            data: { test: 'data' },
        })).resolves.not.toThrow();
        expect(mockZ.console.log).toHaveBeenCalled();
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2VzdHVkaW8vUHJvamVjdHMvR2l0SHViL01JQ1JPU0VSVklDSU9TL2tvcHAtc3RhZGl1bS1jcm1fc2xhY2staHVic3BvdC16YXBwaWVyLW5vdGlvbi9rb3BwLWNybS1hdXRvbWF0aW9uL3Rlc3RzL3phcGllci50ZXN0LnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBUUEsa0JBQWtCO0FBQ2xCLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7QUFUekIsZ0VBQXNDO0FBQ3RDLHVEQUtvQztBQUtwQyxRQUFRLENBQUMseUJBQXlCLEVBQUUsR0FBRyxFQUFFO0lBQ3ZDLElBQUksQ0FBQywyQ0FBMkMsRUFBRSxHQUFHLEVBQUU7UUFDckQsTUFBTSxPQUFPLEdBQUcsZUFBRyxDQUFDLFFBQVEsQ0FBQyxtQkFBbUIsQ0FBQztRQUVqRCxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDOUIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsQ0FBQztRQUNoRCxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1FBQzdDLE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1FBQzFELE1BQU0sQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUMvQyxNQUFNLENBQUMsT0FBTyxPQUFPLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUM1RCxDQUFDLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQyxtQ0FBbUMsRUFBRSxHQUFHLEVBQUU7UUFDN0MsTUFBTSxPQUFPLEdBQUcsZUFBRyxDQUFDLFFBQVEsQ0FBQyxtQkFBbUIsQ0FBQztRQUNq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amVjdHMvR2l0SHViL01JQ1JPU0VSVklDSU9TL2tvcHAtc3RhZGl1bS1jcm1fc2xhY2staHVic3BvdC16YXBwaWVyLW5vdGlvbi9rb3BwLWNybS1hdXRvbWF0aW9uL3Rlc3RzL3phcGllci50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBBcHAgZnJvbSAnLi4vc3JjL3phcGllci9pbmRleCc7XG5pbXBvcnQge1xuICB3aXRoUmV0cnksXG4gIGxvZ1phcEFjdGlvbixcbiAgbWFwRm9ybUZpZWxkc1RvSHViU3BvdCxcbiAgaXNWYWxpZEVtYWlsLFxufSBmcm9tICcuLi9zcmMvemFwaWVyL3V0aWxzL2NvbW1vbic7XG5cbi8vIE1vY2sgZGVsIGxvZ2dlclxuamVzdC5tb2NrKCdmcy9wcm9taXNlcycpO1xuXG5kZXNjcmliZSgnRm9ybSBTdWJtaXNzaW9uIFRyaWdnZXInLCAoKSA9PiB7XG4gIHRlc3QoJ3Nob3VsZCBoYXZlIGNvcnJlY3QgdHJpZ2dlciBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgIGNvbnN0IHRyaWdnZXIgPSBBcHAudHJpZ2dlcnMubmV3X2Zvcm1fc3VibWlzc2lvbjtcblxuICAgIGV4cGVjdCh0cmlnZ2VyKS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdCh0cmlnZ2VyLmtleSkudG9CZSgnbmV3X2Zvcm1fc3VibWlzc2lvbicpO1xuICAgIGV4cGVjdCh0cmlnZ2VyLm5vdW4pLnRvQmUoJ0Zvcm0gU3VibWlzc2lvbicpO1xuICAgIGV4cGVjdCh0cmlnZ2VyLmRpc3BsYXkubGFiZWwpLnRvQmUoJ05ldyBGb3JtIFN1Ym1pc3Npb24nKTtcbiAgICBleHBlY3QodHJpZ2dlci5vcGVyYXRpb24udHlwZSkudG9CZSgncG9sbGluZycpO1xuICAgIGV4cGVjdCh0eXBlb2YgdHJpZ2dlci5vcGVyYXRpb24ucGVyZm9ybSkudG9CZSgnZnVuY3Rpb24nKTtcbiAgfSk7XG5cbiAgdGVzdCgnc2hvdWxkIGhhdmUgY29ycmVjdCBvdXRwdXQgZmllbGRzJywgKCkgPT4ge1xuICAgIGNvbnN0IHRyaWdnZXIgPSBBcHAudHJpZ2dlcnMubmV3X2Zvcm1fc3VibWlzc2lvbjtcbiAgICBjb25zdCBvdXRwdXRGaWVsZHMgPSB0cmlnZ2VyLm9wZXJhdGlvbi5vdXRwdXRGaWVsZHM7XG5cbiAgICBleHBlY3Qob3V0cHV0RmllbGRzKS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChBcnJheS5pc0FycmF5KG91dHB1dEZpZWxkcykpLnRvQmUodHJ1ZSk7XG5cbiAgICBjb25zdCBmaWVsZEtleXMgPSBvdXRwdXRGaWVsZHM/Lm1hcCgoZmllbGQpID0+IGZpZWxkLmtleSkgfHwgW107XG4gICAgZXhwZWN0KGZpZWxkS2V5cykudG9Db250YWluKCdpZCcpO1xuICAgIGV4cGVjdChmaWVsZEtleXMpLnRvQ29udGFpbignY29udGFjdF9lbWFpbCcpO1xuICAgIGV4cGVjdChmaWVsZEtleXMpLnRvQ29udGFpbignc3VibWl0dGVkX2F0Jyk7XG4gICAgZXhwZWN0KGZpZWxkS2V5cykudG9Db250YWluKCdmb3JtX2lkJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBoYXZlIHNhbXBsZSBkYXRhJywgKCkgPT4ge1xuICAgIGNvbnN0IHRyaWdnZXIgPSBBcHAudHJpZ2dlcnMubmV3X2Zvcm1fc3VibWlzc2lvbjtcblxuICAgIGV4cGVjdCh0cmlnZ2VyLm9wZXJhdGlvbi5zYW1wbGUpLnRvQmVEZWZpbmVkKCk7XG4gICAgZXhwZWN0KHRyaWdnZXIub3BlcmF0aW9uLnNhbXBsZSkudG9IYXZlUHJvcGVydHkoJ2lkJyk7XG4gICAgZXhwZWN0KHRyaWdnZXIub3BlcmF0aW9uLnNhbXBsZSkudG9IYXZlUHJvcGVydHkoJ2NvbnRhY3RfZW1haWwnKTtcbiAgICBleHBlY3QodHJpZ2dlci5vcGVyYXRpb24uc2FtcGxlKS50b0hhdmVQcm9wZXJ0eSgnc3VibWl0dGVkX2F0Jyk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdQYWdlIFZpZXcgVHJpZ2dlcicsICgpID0+IHtcbiAgdGVzdCgnc2hvdWxkIGhhdmUgY29ycmVjdCB0cmlnZ2VyIGNvbmZpZ3VyYXRpb24nLCAoKSA9PiB7XG4gICAgY29uc3QgdHJpZ2dlciA9IEFwcC50cmlnZ2Vycy5uZXdfcGFnZV92aWV3O1xuXG4gICAgZXhwZWN0KHRyaWdnZXIpLnRvQmVEZWZpbmVkKCk7XG4gICAgZXhwZWN0KHRyaWdnZXIua2V5KS50b0JlKCduZXdfcGFnZV92aWV3Jyk7XG4gICAgZXhwZWN0KHRyaWdnZXIubm91bikudG9CZSgnUGFnZSBWaWV3Jyk7XG4gICAgZXhwZWN0KHRyaWdnZXIuZGlzcGxheS5sYWJlbCkudG9CZSgnTmV3IFBhZ2UgVmlldycpO1xuICAgIGV4cGVjdCh0cmlnZ2VyLm9wZXJhdGlvbi50eXBlKS50b0JlKCdwb2xsaW5nJyk7XG4gICAgZXhwZWN0KHR5cGVvZiB0cmlnZ2VyLm9wZXJhdGlvbi5wZXJmb3JtKS50b0JlKCdmdW5jdGlvbicpO1xuICB9KTtcblxuICB0ZXN0KCdzaG91bGQgaGF2ZSBjb3JyZWN0IG91dHB1dCBmaWVsZHMnLCAoKSA9PiB7XG4gICAgY29uc3QgdHJpZ2dlciA9IEFwcC50cmlnZ2Vycy5uZXdfcGFnZV92aWV3O1xuICAgIGNvbnN0IG91dHB1dEZpZWxkcyA9IHRyaWdnZXIub3BlcmF0aW9uLm91dHB1dEZpZWxkcztcblxuICAgIGV4cGVjdChvdXRwdXRGaWVsZHMpLnRvQmVEZWZpbmVkKCk7XG4gICAgZXhwZWN0KEFycmF5LmlzQXJyYXkob3V0cHV0RmllbGRzKSkudG9CZSh0cnVlKTtcblxuICAgIGNvbnN0IGZpZWxkS2V5cyA9IG91dHB1dEZpZWxkcz8ubWFwKChmaWVsZCkgPT4gZmllbGQua2V5KSB8fCBbXTtcbiAgICBleHBlY3QoZmllbGRLZXlzKS50b0NvbnRhaW4oJ2lkJyk7XG4gICAgZXhwZWN0KGZpZWxkS2V5cykudG9Db250YWluKCdwYWdlX3VybCcpO1xuICAgIGV4cGVjdChmaWVsZEtleXMpLnRvQ29udGFpbigndGltZXN0YW1wJyk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdIdWJTcG90IENvbnRhY3QgQ3JlYXRlIEFjdGlvbicsICgpID0+IHtcbiAgdGVzdCgnc2hvdWxkIGhhdmUgY29ycmVjdCBjcmVhdGUgY29uZmlndXJhdGlvbicsICgpID0+IHtcbiAgICBjb25zdCBjcmVhdGUgPSBBcHAuY3JlYXRlcy5odWJzcG90X2NvbnRhY3Q7XG5cbiAgICBleHBlY3QoY3JlYXRlKS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChjcmVhdGUua2V5KS50b0JlKCdodWJzcG90X2NvbnRhY3QnKTtcbiAgICBleHBlY3QoY3JlYXRlLm5vdW4pLnRvQmUoJ0NvbnRhY3QnKTtcbiAgICBleHBlY3QoY3JlYXRlLmRpc3BsYXkubGFiZWwpLnRvQmUoJ0NyZWF0ZSBvciBVcGRhdGUgSHViU3BvdCBDb250YWN0Jyk7XG4gICAgZXhwZWN0KHR5cGVvZiBjcmVhdGUub3BlcmF0aW9uLnBlcmZvcm0pLnRvQmUoJ2Z1bmN0aW9uJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBoYXZlIHJlcXVpcmVkIGlucHV0IGZpZWxkcycsICgpID0+IHtcbiAgICBjb25zdCBjcmVhdGUgPSBBcHAuY3JlYXRlcy5odWJzcG90X2NvbnRhY3Q7XG4gICAgY29uc3QgaW5wdXRGaWVsZHMgPSBjcmVhdGUub3BlcmF0aW9uLmlucHV0RmllbGRzO1xuXG4gICAgZXhwZWN0KGlucHV0RmllbGRzKS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGlucHV0RmllbGRzKSkudG9CZSh0cnVlKTtcblxuICAgIGNvbnN0IGVtYWlsRmllbGQgPSBpbnB1dEZpZWxkcy5maW5kKChmaWVsZCkgPT4gZmllbGQua2V5ID09PSAnZW1haWwnKTtcbiAgICBleHBlY3QoZW1haWxGaWVsZCkudG9CZURlZmluZWQoKTtcbiAgICBleHBlY3QoZW1haWxGaWVsZD8ucmVxdWlyZWQpLnRvQmUodHJ1ZSk7XG5cbiAgICBjb25zdCBmaWVsZEtleXMgPSBpbnB1dEZpZWxkcy5tYXAoKGZpZWxkKSA9PiBmaWVsZC5rZXkpO1xuICAgIGV4cGVjdChmaWVsZEtleXMpLnRvQ29udGFpbignZW1haWwnKTtcbiAgICBleHBlY3QoZmllbGRLZXlzKS50b0NvbnRhaW4oJ2ZpcnN0bmFtZScpO1xuICAgIGV4cGVjdChmaWVsZEtleXMpLnRvQ29udGFpbignbGFzdG5hbWUnKTtcbiAgICBleHBlY3QoZmllbGRLZXlzKS50b0NvbnRhaW4oJ2Zvcm1fbmFtZScpO1xuICAgIGV4cGVjdChmaWVsZEtleXMpLnRvQ29udGFpbignc3VibWl0dGVkX2F0Jyk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBoYXZlIHNhbXBsZSBvdXRwdXQnLCAoKSA9PiB7XG4gICAgY29uc3QgY3JlYXRlID0gQXBwLmNyZWF0ZXMuaHVic3BvdF9jb250YWN0O1xuXG4gICAgZXhwZWN0KGNyZWF0ZS5vcGVyYXRpb24uc2FtcGxlKS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChjcmVhdGUub3BlcmF0aW9uLnNhbXBsZSkudG9IYXZlUHJvcGVydHkoJ2VtYWlsJyk7XG4gICAgZXhwZWN0KGNyZWF0ZS5vcGVyYXRpb24uc2FtcGxlKS50b0hhdmVQcm9wZXJ0eSgnZmlyc3RuYW1lJyk7XG4gICAgZXhwZWN0KGNyZWF0ZS5vcGVyYXRpb24uc2FtcGxlKS50b0hhdmVQcm9wZXJ0eSgnbGFzdG5hbWUnKTtcbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ1NsYWNrIE5vdGlmaWNhdGlvbiBDcmVhdGUgQWN0aW9uJywgKCkgPT4ge1xuICB0ZXN0KCdzaG91bGQgaGF2ZSBjb3JyZWN0IGNyZWF0ZSBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgIGNvbnN0IGNyZWF0ZSA9IEFwcC5jcmVhdGVzLnNsYWNrX25vdGlmaWNhdGlvbjtcblxuICAgIGV4cGVjdChjcmVhdGUpLnRvQmVEZWZpbmVkKCk7XG4gICAgZXhwZWN0KGNyZWF0ZS5rZXkpLnRvQmUoJ3NsYWNrX25vdGlmaWNhdGlvbicpO1xuICAgIGV4cGVjdChjcmVhdGUubm91bikudG9CZSgnU2xhY2sgTWVzc2FnZScpO1xuICAgIGV4cGVjdChjcmVhdGUuZGlzcGxheS5sYWJlbCkudG9CZSgnU2VuZCBTbGFjayBOb3RpZmljYXRpb24nKTtcbiAgICBleHBlY3QodHlwZW9mIGNyZWF0ZS5vcGVyYXRpb24ucGVyZm9ybSkudG9CZSgnZnVuY3Rpb24nKTtcbiAgfSk7XG5cbiAgdGVzdCgnc2hvdWxkIGhhdmUgcmVxdWlyZWQgaW5wdXQgZmllbGRzJywgKCkgPT4ge1xuICAgIGNvbnN0IGNyZWF0ZSA9IEFwcC5jcmVhdGVzLnNsYWNrX25vdGlmaWNhdGlvbjtcbiAgICBjb25zdCBpbnB1dEZpZWxkcyA9IGNyZWF0ZS5vcGVyYXRpb24uaW5wdXRGaWVsZHM7XG5cbiAgICBleHBlY3QoaW5wdXRGaWVsZHMpLnRvQmVEZWZpbmVkKCk7XG4gICAgZXhwZWN0KEFycmF5LmlzQXJyYXkoaW5wdXRGaWVsZHMpKS50b0JlKHRydWUpO1xuXG4gICAgY29uc3QgZW1haWxGaWVsZCA9IGlucHV0RmllbGRzLmZpbmQoKGZpZWxkKSA9PiBmaWVsZC5rZXkgPT09ICdlbWFpbCcpO1xuICAgIGV4cGVjdChlbWFpbEZpZWxkKS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChlbWFpbEZpZWxkPy5yZXF1aXJlZCkudG9CZSh0cnVlKTtcblxuICAgIGNvbnN0IGZpZWxkS2V5cyA9IGlucHV0RmllbGRzLm1hcCgoZmllbGQpID0+IGZpZWxkLmtleSk7XG4gICAgZXhwZWN0KGZpZWxkS2V5cykudG9Db250YWluKCdlbWFpbCcpO1xuICAgIGV4cGVjdChmaWVsZEtleXMpLnRvQ29udGFpbignZm9ybV9uYW1lJyk7XG4gICAgZXhwZWN0KGZpZWxkS2V5cykudG9Db250YWluKCdzdWJtaXR0ZWRfYXQnKTtcbiAgfSk7XG5cbiAgdGVzdCgnc2hvdWxkIGhhdmUgc2FtcGxlIG91dHB1dCB3aXRoIEJsb2NrIEtpdCBmb3JtYXQnLCAoKSA9PiB7XG4gICAgY29uc3QgY3JlYXRlID0gQXBwLmNyZWF0ZXMuc2xhY2tfbm90aWZpY2F0aW9uO1xuXG4gICAgZXhwZWN0KGNyZWF0ZS5vcGVyYXRpb24uc2FtcGxlKS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChjcmVhdGUub3BlcmF0aW9uLnNhbXBsZSkudG9IYXZlUHJvcGVydHkoJ2Jsb2NrcycpO1xuICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGNyZWF0ZS5vcGVyYXRpb24uc2FtcGxlLmJsb2NrcykpLnRvQmUodHJ1ZSk7XG5cbiAgICBjb25zdCBmaXJzdEJsb2NrID0gY3JlYXRlLm9wZXJhdGlvbi5zYW1wbGUuYmxvY2tzWzBdO1xuICAgIGV4cGVjdChmaXJzdEJsb2NrKS50b0hhdmVQcm9wZXJ0eSgndHlwZScsICdzZWN0aW9uJyk7XG4gICAgZXhwZWN0KGZpcnN0QmxvY2spLnRvSGF2ZVByb3BlcnR5KCd0ZXh0Jyk7XG4gICAgZXhwZWN0KGZpcnN0QmxvY2sudGV4dCkudG9IYXZlUHJvcGVydHkoJ3R5cGUnLCAnbXJrZHduJyk7XG4gICAgZXhwZWN0KGZpcnN0QmxvY2sudGV4dC50ZXh0KS50b0NvbnRhaW4oJ/Cfk6kgKk51ZXZvIEZvcm0gU3VibWlzc2lvbionKTtcbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ0FwcCBBdXRoZW50aWNhdGlvbicsICgpID0+IHtcbiAgdGVzdCgnc2hvdWxkIGhhdmUgY3VzdG9tIGF1dGhlbnRpY2F0aW9uIGNvbmZpZ3VyYXRpb24nLCAoKSA9PiB7XG4gICAgZXhwZWN0KEFwcC5hdXRoZW50aWNhdGlvbikudG9CZURlZmluZWQoKTtcbiAgICBleHBlY3QoQXBwLmF1dGhlbnRpY2F0aW9uLnR5cGUpLnRvQmUoJ2N1c3RvbScpO1xuICAgIGV4cGVjdChBcHAuYXV0aGVudGljYXRpb24uZmllbGRzKS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChBcnJheS5pc0FycmF5KEFwcC5hdXRoZW50aWNhdGlvbi5maWVsZHMpKS50b0JlKHRydWUpO1xuXG4gICAgY29uc3QgZmllbGRLZXlzID0gQXBwLmF1dGhlbnRpY2F0aW9uLmZpZWxkcy5tYXAoKGZpZWxkKSA9PiBmaWVsZC5rZXkpO1xuICAgIGV4cGVjdChmaWVsZEtleXMpLnRvQ29udGFpbignaHVic3BvdF9hcGlfa2V5Jyk7XG4gICAgZXhwZWN0KGZpZWxkS2V5cykudG9Db250YWluKCdzbGFja193ZWJob29rX3VybCcpO1xuICB9KTtcblxuICB0ZXN0KCdzaG91bGQgaGF2ZSBhdXRoZW50aWNhdGlvbiB0ZXN0IGVuZHBvaW50JywgKCkgPT4ge1xuICAgIGV4cGVjdChBcHAuYXV0aGVudGljYXRpb24udGVzdCkudG9CZURlZmluZWQoKTtcbiAgICBleHBlY3QoQXBwLmF1dGhlbnRpY2F0aW9uLnRlc3QudXJsKS50b0NvbnRhaW4oJ2h1YmFwaS5jb20nKTtcbiAgICBleHBlY3QoQXBwLmF1dGhlbnRpY2F0aW9uLnRlc3QubWV0aG9kKS50b0JlKCdHRVQnKTtcbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ0FwcCBNaWRkbGV3YXJlJywgKCkgPT4ge1xuICB0ZXN0KCdzaG91bGQgaGF2ZSBiZWZvcmVSZXF1ZXN0IG1pZGRsZXdhcmUnLCAoKSA9PiB7XG4gICAgZXhwZWN0KEFwcC5iZWZvcmVSZXF1ZXN0KS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChBcnJheS5pc0FycmF5KEFwcC5iZWZvcmVSZXF1ZXN0KSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoQXBwLmJlZm9yZVJlcXVlc3QubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgZXhwZWN0KHR5cGVvZiBBcHAuYmVmb3JlUmVxdWVzdFswXSkudG9CZSgnZnVuY3Rpb24nKTtcbiAgfSk7XG5cbiAgdGVzdCgnc2hvdWxkIGhhdmUgYWZ0ZXJSZXNwb25zZSBtaWRkbGV3YXJlJywgKCkgPT4ge1xuICAgIGV4cGVjdChBcHAuYWZ0ZXJSZXNwb25zZSkudG9CZURlZmluZWQoKTtcbiAgICBleHBlY3QoQXJyYXkuaXNBcnJheShBcHAuYWZ0ZXJSZXNwb25zZSkpLnRvQmUodHJ1ZSk7XG4gICAgZXhwZWN0KEFwcC5hZnRlclJlc3BvbnNlLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgIGV4cGVjdCh0eXBlb2YgQXBwLmFmdGVyUmVzcG9uc2VbMF0pLnRvQmUoJ2Z1bmN0aW9uJyk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdVdGlsaXR5IEZ1bmN0aW9ucycsICgpID0+IHtcbiAgdGVzdCgnd2l0aFJldHJ5IHNob3VsZCBoYW5kbGUgZmFpbHVyZXMgYW5kIHJldHJpZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgbGV0IGF0dGVtcHRzID0gMDtcbiAgICBjb25zdCBmbGFreU9wZXJhdGlvbiA9IGplc3QuZm4oYXN5bmMgKCkgPT4ge1xuICAgICAgYXR0ZW1wdHMrKztcbiAgICAgIGlmIChhdHRlbXB0cyA8IDMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUZW1wb3JhcnkgZmFpbHVyZScpO1xuICAgICAgfVxuICAgICAgcmV0dXJuICdzdWNjZXNzJztcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHdpdGhSZXRyeShmbGFreU9wZXJhdGlvbiwgMywgMTApO1xuXG4gICAgZXhwZWN0KHJlc3VsdCkudG9CZSgnc3VjY2VzcycpO1xuICAgIGV4cGVjdChhdHRlbXB0cykudG9CZSgzKTtcbiAgICBleHBlY3QoZmxha3lPcGVyYXRpb24pLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygzKTtcbiAgfSk7XG5cbiAgdGVzdCgnd2l0aFJldHJ5IHNob3VsZCBmYWlsIGFmdGVyIG1heCByZXRyaWVzJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGFsd2F5c0ZhaWxPcGVyYXRpb24gPSBqZXN0LmZuKGFzeW5jICgpID0+IHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQWx3YXlzIGZhaWxzJyk7XG4gICAgfSk7XG5cbiAgICBhd2FpdCBleHBlY3Qod2l0aFJldHJ5KGFsd2F5c0ZhaWxPcGVyYXRpb24sIDIsIDEwKSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgJ0Fsd2F5cyBmYWlscydcbiAgICApO1xuXG4gICAgZXhwZWN0KGFsd2F5c0ZhaWxPcGVyYXRpb24pLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygzKTsgLy8gaW5pdGlhbCArIDIgcmV0cmllc1xuICB9KTtcblxuICB0ZXN0KCdtYXBGb3JtRmllbGRzVG9IdWJTcG90IHNob3VsZCBtYXAgZm9ybSBmaWVsZHMgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSBbXG4gICAgICB7IG5hbWU6ICdlbWFpbCcsIHZhbHVlOiAndGVzdEBleGFtcGxlLmNvbScgfSxcbiAgICAgIHsgbmFtZTogJ2ZpcnN0X25hbWUnLCB2YWx1ZTogJ0pvaG4nIH0sXG4gICAgICB7IG5hbWU6ICdsYXN0X25hbWUnLCB2YWx1ZTogJ0RvZScgfSxcbiAgICAgIHsgbmFtZTogJ3Bob25lJywgdmFsdWU6ICcrMS0yMzQtNTY3LTg5MDAnIH0sXG4gICAgICB7IG5hbWU6ICdjb21wYW55JywgdmFsdWU6ICdUZXN0IENvcnAnIH0sXG4gICAgXTtcblxuICAgIGNvbnN0IG1hcHBlZCA9IG1hcEZvcm1GaWVsZHNUb0h1YlNwb3QoZm9ybVZhbHVlcyk7XG5cbiAgICBleHBlY3QobWFwcGVkKS50b0hhdmVQcm9wZXJ0eSgnZW1haWwnLCAndGVzdEBleGFtcGxlLmNvbScpO1xuICAgIGV4cGVjdChtYXBwZWQpLnRvSGF2ZVByb3BlcnR5KCdmaXJzdG5hbWUnLCAnSm9obicpO1xuICAgIGV4cGVjdChtYXBwZWQpLnRvSGF2ZVByb3BlcnR5KCdsYXN0bmFtZScsICdEb2UnKTtcbiAgICBleHBlY3QobWFwcGVkKS50b0hhdmVQcm9wZXJ0eSgncGhvbmUnLCAnKzEyMzQ1Njc4OTAwJyk7XG4gICAgZXhwZWN0KG1hcHBlZCkudG9IYXZlUHJvcGVydHkoJ2NvbXBhbnknLCAnVGVzdCBDb3JwJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ21hcEZvcm1GaWVsZHNUb0h1YlNwb3Qgc2hvdWxkIHNraXAgaW52YWxpZCBlbWFpbHMnLCAoKSA9PiB7XG4gICAgY29uc3QgZm9ybVZhbHVlcyA9IFtcbiAgICAgIHsgbmFtZTogJ2VtYWlsJywgdmFsdWU6ICdpbnZhbGlkLWVtYWlsJyB9LFxuICAgICAgeyBuYW1lOiAnZmlyc3RuYW1lJywgdmFsdWU6ICdKb2huJyB9LFxuICAgIF07XG5cbiAgICBjb25zdCBtYXBwZWQgPSBtYXBGb3JtRmllbGRzVG9IdWJTcG90KGZvcm1WYWx1ZXMpO1xuXG4gICAgZXhwZWN0KG1hcHBlZCkubm90LnRvSGF2ZVByb3BlcnR5KCdlbWFpbCcpO1xuICAgIGV4cGVjdChtYXBwZWQpLnRvSGF2ZVByb3BlcnR5KCdmaXJzdG5hbWUnLCAnSm9obicpO1xuICB9KTtcblxuICB0ZXN0KCdpc1ZhbGlkRW1haWwgc2hvdWxkIHZhbGlkYXRlIGVtYWlsIGFkZHJlc3NlcyBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgZXhwZWN0KGlzVmFsaWRFbWFpbCgndGVzdEBleGFtcGxlLmNvbScpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChpc1ZhbGlkRW1haWwoJ3VzZXIubmFtZSt0YWdAZXhhbXBsZS5jby51aycpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChpc1ZhbGlkRW1haWwoJ2ludmFsaWQtZW1haWwnKSkudG9CZShmYWxzZSk7XG4gICAgZXhwZWN0KGlzVmFsaWRFbWFpbCgnJykpLnRvQmUoZmFsc2UpO1xuICAgIGV4cGVjdChpc1ZhbGlkRW1haWwoJ3Rlc3RAJykpLnRvQmUoZmFsc2UpO1xuICAgIGV4cGVjdChpc1ZhbGlkRW1haWwoJ0BleGFtcGxlLmNvbScpKS50b0JlKGZhbHNlKTtcbiAgICBleHBlY3QoaXNWYWxpZEVtYWlsKCd0ZXN0Li50ZXN0QGV4YW1wbGUuY29tJykpLnRvQmUoZmFsc2UpO1xuICB9KTtcblxuICB0ZXN0KCdsb2daYXBBY3Rpb24gc2hvdWxkIGhhbmRsZSBsb2dnaW5nIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgbW9ja1ogPSB7XG4gICAgICBjb25zb2xlOiB7XG4gICAgICAgIGxvZzogamVzdC5mbigpLFxuICAgICAgICBlcnJvcjogamVzdC5mbigpLFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgLy8gU2hvdWxkIG5vdCB0aHJvdyBldmVuIGlmIGxvZ2dpbmcgZmFpbHNcbiAgICBhd2FpdCBleHBlY3QoXG4gICAgICBsb2daYXBBY3Rpb24obW9ja1osIHtcbiAgICAgICAgYWN0aW9uOiAndGVzdF9hY3Rpb24nLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogeyB0ZXN0OiAnZGF0YScgfSxcbiAgICAgIH0pXG4gICAgKS5yZXNvbHZlcy5ub3QudG9UaHJvdygpO1xuXG4gICAgZXhwZWN0KG1vY2taLmNvbnNvbGUubG9nKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=