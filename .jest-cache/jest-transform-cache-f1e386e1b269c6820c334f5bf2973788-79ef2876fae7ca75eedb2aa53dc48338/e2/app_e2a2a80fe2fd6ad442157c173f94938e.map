{"file":"/Users/estudio/Projects/GitHub/MICROSERVICIOS/kopp-stadium-crm_slack-hubspot-zappier-notion/kopp-crm-automation/src/app.ts","mappings":"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","names":[],"sources":["/Users/estudio/Projects/GitHub/MICROSERVICIOS/kopp-stadium-crm_slack-hubspot-zappier-notion/kopp-crm-automation/src/app.ts"],"sourcesContent":["import express from 'express';\nimport cors from 'cors';\nimport { setupSwagger } from './config/swagger';\nimport healthRoutes from './routes/health';\nimport slackRoutes from './routes/slack';\nimport hubspotRoutes from './routes/hubspot';\nimport zapierRoutes from './routes/zapier';\n\nconst app = express();\nconst PORT = process.env.PORT || 3000;\n\n// Middleware básico\napp.use(cors());\napp.use(express.json({ limit: '10mb' }));\napp.use(express.urlencoded({ extended: true }));\n\n// Middleware de logging simple\napp.use((req, res, next) => {\n  const timestamp = new Date().toISOString();\n  console.log(`${timestamp} - ${req.method} ${req.path}`);\n  next();\n});\n\n/**\n * @swagger\n * /:\n *   get:\n *     tags: [Health]\n *     summary: Endpoint raíz de la API\n *     description: |\n *       Endpoint de bienvenida que proporciona información básica sobre la API de Kopp Stadium CRM.\n *\n *       **Información incluida:**\n *       - 🎯 Nombre y versión de la API\n *       - 📚 Enlaces a documentación\n *       - 🔗 Endpoints disponibles\n *       - 📊 Estado general del sistema\n *       - 🚀 Información de despliegue\n *     responses:\n *       200:\n *         description: Información de bienvenida de la API\n *         content:\n *           application/json:\n *             schema:\n *               type: object\n *               properties:\n *                 message:\n *                   type: string\n *                   description: Mensaje de bienvenida\n *                 api:\n *                   type: object\n *                   properties:\n *                     name: { type: string }\n *                     version: { type: string }\n *                     description: { type: string }\n *                 documentation:\n *                   type: object\n *                   properties:\n *                     swagger_ui: { type: string }\n *                     openapi_json: { type: string }\n *                     openapi_yaml: { type: string }\n *                 endpoints:\n *                   type: object\n *                   properties:\n *                     health: { type: array, items: { type: string } }\n *                     slack: { type: array, items: { type: string } }\n *                     hubspot: { type: array, items: { type: string } }\n *                     zapier: { type: array, items: { type: string } }\n *                 integrations:\n *                   type: object\n *                   properties:\n *                     slack: { type: string }\n *                     hubspot: { type: string }\n *                     zapier: { type: string }\n *                     google_sheets: { type: string }\n *                 features:\n *                   type: array\n *                   items: { type: string }\n *                 timestamp:\n *                   type: string\n *                   format: date-time\n *             example:\n *               message: \"🏟️ Bienvenido a Kopp Stadium CRM API\"\n *               api:\n *                 name: \"Kopp Stadium CRM API\"\n *                 version: \"1.0.0\"\n *                 description: \"Automatización estratégica de CRM con integración completa\"\n *               documentation:\n *                 swagger_ui: \"/api-docs\"\n *                 openapi_json: \"/api-docs.json\"\n *                 openapi_yaml: \"/api-docs.yaml\"\n *               endpoints:\n *                 health: [\"/health\", \"/health/detailed\", \"/version\"]\n *                 slack: [\"/slack/notify\", \"/slack/channels\", \"/slack/webhook\"]\n *                 hubspot: [\"/hubspot/contacts\", \"/hubspot/contacts/{id}/score\"]\n *                 zapier: [\"/zapier/webhook/lead-scoring\", \"/zapier/webhook/form-submission\", \"/zapier/status\"]\n *               integrations:\n *                 slack: \"Notificaciones y alertas en tiempo real\"\n *                 hubspot: \"Gestión de leads y contactos CRM\"\n *                 zapier: \"Automatización de workflows\"\n *                 google_sheets: \"Lead scoring y análisis\"\n *               features:\n *                 - \"🔒 Seguridad implementada con validación de tokens\"\n *                 - \"⚡ Ultra cost-optimized CI/CD\"\n *                 - \"📊 Lead scoring automático\"\n *                 - \"🔔 Notificaciones inteligentes\"\n *                 - \"🧪 Testing completo y coverage\"\n *                 - \"📋 ADRs implementados\"\n *                 - \"🎯 Rate limiting y validaciones\"\n *               timestamp: \"2024-06-29T18:00:00.000Z\"\n */\napp.get('/', (req, res) => {\n  res.json({\n    message: '🏟️ Bienvenido a Kopp Stadium CRM API',\n    api: {\n      name: 'Kopp Stadium CRM API',\n      version: '1.0.0',\n      description: 'Automatización estratégica de CRM con integración completa',\n    },\n    documentation: {\n      swagger_ui: '/api-docs',\n      openapi_json: '/api-docs.json',\n      openapi_yaml: '/api-docs.yaml',\n    },\n    endpoints: {\n      health: ['/health', '/health/detailed', '/version'],\n      slack: ['/slack/notify', '/slack/channels', '/slack/webhook'],\n      hubspot: ['/hubspot/contacts', '/hubspot/contacts/{id}/score'],\n      zapier: [\n        '/zapier/webhook/lead-scoring',\n        '/zapier/webhook/form-submission',\n        '/zapier/status',\n      ],\n    },\n    integrations: {\n      slack: 'Notificaciones y alertas en tiempo real',\n      hubspot: 'Gestión de leads y contactos CRM',\n      zapier: 'Automatización de workflows',\n      google_sheets: 'Lead scoring y análisis',\n    },\n    features: [\n      '🔒 Seguridad implementada con validación de tokens',\n      '⚡ Ultra cost-optimized CI/CD',\n      '📊 Lead scoring automático',\n      '🔔 Notificaciones inteligentes',\n      '🧪 Testing completo y coverage',\n      '📋 ADRs implementados',\n      '🎯 Rate limiting y validaciones',\n    ],\n    timestamp: new Date().toISOString(),\n  });\n});\n\n// Configurar rutas\napp.use('/', healthRoutes);\napp.use('/slack', slackRoutes);\napp.use('/hubspot', hubspotRoutes);\napp.use('/zapier', zapierRoutes);\n\n// Configurar Swagger\nsetupSwagger(app);\n\n// Middleware de manejo de errores\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\napp.use(\n  (\n    err: any,\n    req: express.Request,\n    res: express.Response,\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    _next: express.NextFunction\n  ) => {\n    console.error('Error:', err);\n    res.status(500).json({\n      error: 'INTERNAL_SERVER_ERROR',\n      message: 'Error interno del servidor',\n      timestamp: new Date().toISOString(),\n    });\n  }\n);\n\n// Middleware para rutas no encontradas\napp.use('*', (req, res) => {\n  res.status(404).json({\n    error: 'ENDPOINT_NOT_FOUND',\n    message: `Endpoint ${req.method} ${req.originalUrl} no encontrado`,\n    available_endpoints: {\n      documentation: '/api-docs',\n      health: '/health',\n      slack: '/slack/*',\n      hubspot: '/hubspot/*',\n      zapier: '/zapier/*',\n    },\n    timestamp: new Date().toISOString(),\n  });\n});\n\n// Iniciar servidor solo si no estamos en entorno de testing\nif (process.env.NODE_ENV !== 'test') {\n  app.listen(PORT, () => {\n    console.log('🚀 Kopp Stadium CRM API iniciada exitosamente!');\n    console.log(`📍 Servidor ejecutándose en http://localhost:${PORT}`);\n    console.log(`📚 Documentación Swagger: http://localhost:${PORT}/api-docs`);\n    console.log(`🔍 Health Check: http://localhost:${PORT}/health`);\n    console.log(`⚡ Environment: ${process.env.NODE_ENV || 'development'}`);\n    console.log('');\n    console.log('🎯 Endpoints principales:');\n    console.log('   - GET  /health - Verificación de salud');\n    console.log('   - POST /slack/notify - Notificaciones Slack');\n    console.log('   - POST /hubspot/contacts - Crear contactos');\n    console.log('   - POST /zapier/webhook/lead-scoring - Webhook scoring');\n    console.log(\n      '   - POST /zapier/webhook/form-submission - Webhook formularios'\n    );\n    console.log('');\n    console.log('🔗 Integraciones activas:');\n    console.log('   - 📢 Slack API');\n    console.log('   - 📊 HubSpot CRM');\n    console.log('   - ⚡ Zapier Webhooks');\n    console.log('   - 📈 Google Sheets');\n    console.log('');\n    console.log('✨ ¡API lista para automatizar Kopp Stadium CRM!');\n  });\n}\n\nexport default app;\n"],"version":3}